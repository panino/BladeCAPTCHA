self.addEventListener("message",async e=>{const{challenge:t,difficulty:s,loguear:a,progress:n,start:r=0,end:o=1/0,timeFactor:i=1}=e.data,d="0".repeat(s),l=new TextEncoder,c=async e=>{const t=l.encode(e),s=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(s)).map(e=>e.toString(16).padStart(2,"0")).join("")};let f=r;const p=Date.now(),g=(1e4+3e3*s)*i;let u=0;for(;f<o;){if((await c(t+f)).startsWith(d))return void self.postMessage({nonce:f});if(f++,n&&f%100==0){let e=(f-r)/(o-r)*100;e>100&&(e=100),e>=u&&(u=e,self.postMessage({perc:e.toFixed(2),start:r,end:o}))}if(Date.now()-p>g)return void self.postMessage({done:!0,partial:!0,nextStart:f,end:o});if(a&&f%1e4==0){const e=f-r;self.postMessage({attempts:e})}}self.postMessage({done:!0,start:r,end:o})});